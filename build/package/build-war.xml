<?xml version="1.0" encoding="UTF-8"?>
<project default="war.zip" basedir="." name="lucee.war" xmlns:antcontrib="antlib:net.sf.antcontrib">

	<import file="../build-core.xml"/>
	
  <target name="war.zip" depends="libs.zip" description="builds the war package">
    <!-- jars zip  -->
    <zip destfile="${dist.dir}/bundles/lucee-${version}-jars.zip">
      <zipfileset dir="${dist.dir}" includes="lucee.jar,lucee-inst.jar"/>
      <zipfileset dir="${lib}" includes="*felix*.jar"/>
      <zipfileset dir="${lib}" excludes=".classpath,.project,javax*servlet*.jar,*felix*.jar" prefix="lucee-server/bundles"/>
    </zip>

    <!-- war file  -->
    <zip destfile="${dist.dir}/bundles/lucee-${version}.war">
        <!-- jars -->
        <zipfileset dir="${dist.dir}" includes="lucee.jar,lucee-inst.jar" prefix="WEB-INF/lib"/>
        <zipfileset dir="${lib}" includes="*felix*.jar" prefix="WEB-INF/lib"/>
        <zipfileset dir="${lib}" excludes=".classpath,.project,javax*servlet*.jar,*felix*.jar" prefix="lucee-server/bundles"/>
        <!-- common files -->
        <zipfileset dir="${resource.dir}/common"/>
        <!-- war specific files -->
        <zipfileset dir="${resource.dir}/war"/>
        <!-- website files -->
        <zipfileset dir="${resource.dir}/website"/>
    </zip>

  </target>

  <target name="war.artifact" depends="war.zip" description="create core artifact">
    <pom-and-deploy pomid="luceewar.pom" artifact="${dist.dir}/bundles/lucee-${version}.war" packaging="war" buildtype="${mvn.type}"
     groupId="org.lucee" artifactId="lucee.war" version="${version}" name="lucee.war" />
  </target>
	
</project>